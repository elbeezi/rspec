<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>An operand of a boolean expression that never changes the result of the expression might not match the programmer&#8217;s intent and can lead to unexpected behavior and potential bugs.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbnet" data-lang="vbnet">Dim a = True

If a Then
    DoSomething()
End If</code></pre>
</div>
</div>
<div class="paragraph">
<p>This also applies to the <a href="https://learn.microsoft.com/en-us/dotnet/visual-basic/language-reference/operators/null-conditional-operators">null conditional operator</a> when one of the operands always evaluates to <code>Nothing</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbnet" data-lang="vbnet">Dim d As String = Nothing
Dim v1 = If(d, "value")</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_exceptions">Exceptions</h3>
<div class="paragraph">
<p>This rule will not raise an issue in either of these cases:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When the condition is a single <code>Const bool</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbnet" data-lang="vbnet">Const debug = False
'...
If debug Then
    ' Print something
End If</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>When the condition is the literal <code>True</code> or <code>False</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In these cases, it is obvious the code is as intended.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The conditions should be reviewed to decide whether:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>to update the unnecessary operand</p>
</li>
<li>
<p>to remove the unnecessary operand</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbnet" data-lang="vbnet">Public Sub Sample(ByVal b As Boolean, ByVal c As Boolean)
    Dim a = True
    If a Then                  ' Noncompliant: "a" is always "true"
        DoSomething()
    End If

    If b AndAlso a Then        ' Noncompliant: "a" is always "true"
        DoSomething()
    End If

    If c OrElse Not a Then     ' Noncompliant: "Not a" is always "false"
        DoSomething()
    End If

    Dim d As String = Nothing
    Dim v1 = If(d, "value")    ' Noncompliant: "d" is always Nothing and v1 is always "value".
    Dim v2 = If(s, d)          ' Noncompliant: "d" is always Nothing and v2 is always equal to s.
End Sub</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbnet" data-lang="vbnet">Public Sub Sample(ByVal b As Boolean, ByVal c As Boolean, ByVal s As String)
    Dim a = IsAllowed()
    If a Then                   ' Compliant
        DoSomething()
    End If

    If b AndAlso a Then         ' Compliant
        DoSomething()
    End If

    If c OrElse Not a Then      ' Compliant
        DoSomething()
    End If

    Dim d As String = GetStringData()
    Dim v1 = If(d, "value")     ' Compliant
    Dim v2 = If(s, d)           ' Compliant
End Sub</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/571">MITRE, CWE-571</a> - Expression is Always True</p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/570">MITRE, CWE-570</a> - Expression is Always False</p>
</li>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/dotnet/visual-basic/programming-guide/language-features/operators-and-expressions/logical-and-bitwise-operators">Logical and Bitwise Operators in Visual Basic</a></p>
</li>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/dotnet/visual-basic/language-reference/operators/null-conditional-operators">?. and ?() null-conditional operators (Visual Basic)</a></p>
</li>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/dotnet/visual-basic/language-reference/operators/null-conditional-operators">If operator called with two arguments</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="ulist">
<ul>
<li>
<p>Change this condition so that it does not always evaluate to "[true|false]".</p>
</li>
<li>
<p>Change this expression which always evaluates to the same result.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>Primary: the gratuitous expression</p>
</div>
<div class="paragraph">
<p>Secondary: the last locations in the code leading to know something on each variable part of the gratuitous expression.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_deprecates_s1850">deprecates: <a data-rspec-id="S1850" class="rspec-auto-link">S1850</a></h3>

</div>
<div class="sect2">
<h3 id="_is_related_to_s3650">is related to: <a data-rspec-id="S3650" class="rspec-auto-link">S3650</a></h3>

</div>
<div class="sect2">
<h3 id="_relates_to_s1764">relates to: <a data-rspec-id="S1764" class="rspec-auto-link">S1764</a></h3>

</div>
<div class="sect2">
<h3 id="_on_1_feb_2016_102145_freddy_mallet_wrote">on 1 Feb 2016, 10:21:45 Freddy Mallet wrote:</h3>
<div class="paragraph">
<p>Question : should we consider this RSPEC as being fully a subset of <a data-rspec-id="S2583" class="rspec-auto-link">RSPEC-2583</a> ? I think the only motivation behind this split was to use a different severity and this remains a relevant point.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_29_feb_2016_083704_pierre_yves_nicolas_wrote">on 29 Feb 2016, 08:37:04 Pierre-Yves Nicolas wrote:</h3>
<div class="paragraph">
<p>\[~freddy.mallet] I don&#8217;t really see why this RSPEC is "fully a subset of <a data-rspec-id="S2583" class="rspec-auto-link">RSPEC-2583</a>". Maybe that makes sense if it is implemented through symbolic execution with short-circuit logical operators, but then it all depends on the order of sub-conditions. Please consider <code>IF X &gt; 1 AND X = 5</code>: I think that this code would raise an issue for the current description of this RSPEC, but not for <a data-rspec-id="S2583" class="rspec-auto-link">RSPEC-2583</a>.</p>
</div>
</div>
</div>
</div>