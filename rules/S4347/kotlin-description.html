<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When using <code>SecureRandom</code>, it is important not to use predictable seeds. This class is used to generate cryptographically strong random numbers. Using a predictable seed will make its output predictable as well, which counteracts the use case of <code>SecureRandom</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>java.security.SecureRandom</code> is often used to generate random values for cryptographic algorithms. When a random number generator is used for cryptographic purposes, the generated numbers must be as random and unpredictable as possible. When <code>SecureRandom</code> is improperly seeded with a constant or a predictable value, its output will also be predictable.</p>
</div>
<div class="paragraph">
<p>This can have severe security implications for cryptographic operations that rely on the randomness of the generated numbers. By using a predictable seed, an attacker can potentially guess or deduce the generated numbers, compromising the security of whatever cryptographic algorithm relies on <code>SecureRandom</code>.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>It is crucial to understand that the strength of cryptographic algorithms heavily relies on the quality of the random numbers used. By improperly seeding the <code>SecureRandom</code> class, we introduce a significant weakness that can be exploited by attackers.</p>
</div>
<div class="sect3">
<h4 id="_insecure_cryptographic_keys">Insecure cryptographic keys</h4>
<div class="paragraph">
<p>One of the primary use cases for the <code>SecureRandom</code> class is generating cryptographic keys. If an attacker can predict the seed used to initialize the SecureRandom instance, they may be able to derive the same keys. Depending on the use case, this can lead to multiple severe outcomes, such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Being able to decrypt sensitive documents, leading to privacy breaches or identity theft.</p>
</li>
<li>
<p>Gaining access to a private key used for signing, allowing an attacker to forge digital signatures and impersonate legitimate entities.</p>
</li>
<li>
<p>Bypassing authentication mechanisms that rely on public-key infrastructure (PKI), which can be abused to gain unauthorized access to systems or networks.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_session_hijacking_and_man_in_the_middle_attack">Session hijacking and man-in-the-middle attack</h4>
<div class="paragraph">
<p>Another scenario where this vulnerability can be exploited is in the generation of session tokens or nonces for secure communication protocols. If an attacker can predict the seed used to generate these tokens, they can impersonate legitimate users or intercept sensitive information.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it_in_java_se">How to fix it in Java SE</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="paragraph">
<p>The following code uses a cryptographically strong random number generator to generate data that is not cryptographically strong.</p>
</div>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin">import java.security.SecureRandom

val sr = SecureRandom()
sr.setSeed(123456L) // Noncompliant
val v = sr.nextInt()</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin">import java.security.SecureRandom

val sr = SecureRandom("abcdefghijklmnop".toByteArray(charset("us-ascii"))) // Noncompliant
val v = sr.nextInt()</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin">import java.security.SecureRandom

val sr = SecureRandom()
val v = sr.nextInt()</code></pre>
</div>
</div>
<div class="paragraph">
<p>This solution is available for JDK 1.8 and higher.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin">import java.security.SecureRandom

val sr = SecureRandom.getInstanceStrong()
val v = sr.nextInt()</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_does_this_work">How does this work?</h3>
<div class="paragraph">
<p>When the randomly generated data needs to be cryptographically strong, <code>SecureRandom</code> is the correct class to use. However, its documentation also cites that "any seed material passed to a <code>SecureRandom</code> object must be unpredictable". When no seed is passed by the user to the object, the <code>SecureRandom</code> object chooses an unpredictable seed by default. Therefore, the easiest way to fix the issue is to use the default constructor without any calls to <code>SecureObject.setSeed()</code>.</p>
</div>
<div class="paragraph">
<p>To go the extra mile, <code>SecureObject.getInstanceStrong()</code> returns an instance of <code>SecureObject</code> that is guaranteed to use a strong algorithm for its number generation.</p>
</div>
<div class="paragraph">
<p>If the randomly generated data is not used for cryptographic purposes and is not business critical, it may be a better choice to use <code>java.util.Random</code> instead. In this case, setting a predictable seed may be acceptable depending on the situation.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Java Documentation - <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/security/SecureRandom.html">Class <code>java.security.SecureRandom</code></a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures</p>
</li>
<li>
<p><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security Misconfiguration</p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/330">MITRE, CWE-330</a> - Use of Insufficiently Random Values</p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/332">MITRE, CWE-332</a> - Insufficient Entropy in PRNG</p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/336">MITRE, CWE-336</a> - Same Seed in Pseudo-Random Number Generator (PRNG)</p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/337">MITRE, CWE-337</a> - Predictable Seed in Pseudo-Random Number Generator (PRNG)</p>
</li>
<li>
<p><a href="https://wiki.sei.cmu.edu/confluence/display/java/MSC63-J.+Ensure+that+SecureRandom+is+properly+seeded">CERT, MSC63J.</a> - Ensure that SecureRandom is properly seeded</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Change this seed value to something unpredictable, or remove the seed.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>The call to SecureRandom.setSeed() or the SecureRandom(byte[]) constructor call</p>
</div>
<hr>
</div>
</div>
</div>